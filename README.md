# Лабораторная работа № 2-05. «Аппроксимация (интерполяция и экстраполяция) функций».

## ТЗ

Протабулировать заданную функцию (вычислить массив значений функции) y = f(x) = на интервале `[a, b]` с шагом, Δx = (b - a) / n, т.е. задать таблицу (x_i, y_i) для i = 0, 1, 2, ..., n. Построить графики. Исходные данные: f(x) = x * (1 + x)^(1/3), a = 1, b = 9, n = 8

## Задание 1.

С помощью метода наименьших квадратов (МНК) аппроксимировать заданную таблично функцию (см. выше) полиномами 2-й, 3-й, 4-й и 5-й степеней. Определить абсолютную и относительную погрешности в каждой точке аппроксимации для каждого из полиномов. Обосновать выбор наилучшей (и почему) аппроксимирующей функции.
Для решения задачи использовать метод Гаусса или Гаусса-Жордана (на выбор). Для каждого из многочленов вычислить максимальные отклонения от точных значений функций в точках x_i = a + Δx(i + 0.5), i = 0, 1, 2, ..., n-1.

Проверить полученные результаты в среде Matlab и MS Excel.

## Задание 2.

С помощью интерполяционного многочлена Лагранжа вычислить значения заданной таблично функции (см. выше) в промежуточных точках x_j = a + Δx(j + 0.5), j = 0, 1, 2, ..., n-1. Сравнить полученные значения с точными значениями функции в этих точках (узлах). Оценить погрешность вычислений (абсолютная и относительная)

## Описание методов

1. Что такое Аппроксимация?

Представьте, что у вас есть сложная или неизвестная функция. Например, вы сняли показания прибора в нескольких точках, но вы не знаете точную формулу, которая их связывает.

Аппроксимация (или приближение) — это процесс замены этой сложной или неизвестной функции на другую, более простую и удобную (например, на многочлен). Мы делаем это, чтобы можно было легко:
    - Вычислять значения функции в любых точках (а не только в тех, которые мы измерили).
    - Находить производные, интегралы и т.д.

В нашей задаче есть два основных вида аппроксимации:

- Интерполяция: Построение такой функции, которая точно проходит через все заданные точки. Метод Лагранжа — это интерполяция.
- Собственно аппроксимация (сглаживание): Построение функции, которая проходит как можно ближе к заданным точкам, но не обязательно через них. Это полезно, когда исходные данные могут содержать погрешности ("шум"). Метод наименьших квадратов — это такой вид аппроксимации.

2. Метод Наименьших Квадратов (МНК) — Задание 1

Цель: Найти такую линию (в нашем случае — многочлен), которая лучше всего описывает «тренд» в данных. Она не обязана проходить через каждую точку, но должна лежать максимально близко ко всем ним.

Как он работает?

Идея: Для каждой исходной точки (x_i, y_i) мы вычисляем "ошибку" (или отклонение) — это расстояние по вертикали между реальным значением y_i и значением на нашей аппроксимирующей кривой.
"Наименьшие квадраты": Мы не можем просто сложить эти отклонения, так как некоторые будут положительными (точка выше кривой), а некоторые — отрицательными (точка ниже), и они могут друг друга скомпенсировать. Чтобы этого избежать, каждое отклонение возводят в квадрат (так все ошибки становятся положительными).
Минимизация: Метод находит такие коэффициенты для многочлена, при которых сумма квадратов всех этих отклонений будет минимально возможной. Отсюда и название.

В коде:

Мы перебираем полиномы разных степеней (2, 3, 4, 5).
Для каждой степени мы составляем так называемую "систему нормальных уравнений". Ее решение дает нам коэффициенты a0, a1, a2, ... для наилучшего многочлена этой степени.
Строка coeffs = np.linalg.solve(A, B) как раз и решает эту систему, находя те самые "идеальные" коэффициенты.
Мы выбираем лучший полином, сравнивая их погрешности не в самих узлах, а между ними, так как это лучше показывает, насколько хорошо полином уловил поведение исходной функции.

Простыми словами: МНК проводит линию "посередине" разбросанных точек так, чтобы суммарное квадратичное "расстояние" от всех точек до этой линии было самым маленьким.
3. Интерполяционный многочлен Лагранжа — Задание 2

Цель: Найти единственный многочлен, который гарантированно пройдет точно через все заданные точки.

Как он работает?
Метод Лагранжа очень элегантен. Вместо того чтобы решать сложную систему уравнений для поиска коэффициентов, он строит итоговый многочлен L(x) как сумму нескольких "базисных" многочленов.

Для каждой точки (x_j, y_j) строится свой уникальный базисный многочлен l_j(x).
Этот многочлен l_j(x) обладает хитрым свойством: он равен 1 в точке x_j и 0 во всех остальных узловых точках x_i.
Итоговый многочлен собирается как "взвешенная" сумма этих базисных многочленов: L(x) = y_0*l_0(x) + y_1*l_1(x) + ... + y_n*l_n(x).

Когда вы подставите в эту формулу x равный одному из узлов, например x_k, все слагаемые, кроме одного, превратятся в ноль, и вы получите L(x_k) = y_k, что и требовалось.

В коде:

Функция lagrange_interpolation в точности реализует эту идею.
Внешний цикл по j суммирует слагаемые y_j * l_j(x).
Внутренний цикл по i вычисляет сам базисный многочлен l_j(x).

Простыми словами: Лагранж строит кривую, которая, как иголкой с ниткой, точно "прошивает" каждую заданную точку. Это полезно, когда вы уверены в точности своих данных и хотите узнать значение функции между ними.

Итог: Ключевое различие

    МНК (Аппроксимация): Ищет "средний" тренд. Полезно для зашумленных данных. Кривая проходит рядом с точками.
    Лагранж (Интерполяция): Требует точного совпадения. Полезно для точных данных. Кривая проходит через точки.
